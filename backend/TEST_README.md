# 运动手环API测试说明

本目录包含两个测试文件，用于测试后端API是否正常工作：

1. `test_api.py` - Python测试脚本
2. `test_api.html` - 浏览器测试界面

## 准备工作

在开始测试之前，请确保：

1. 后端服务器已启动（通过 `python -m backend.run` 命令）
2. 数据库连接正常配置

## 使用Python脚本测试

Python脚本提供了一个简单的命令行测试工具，按顺序执行所有API测试并显示结果。

### 安装依赖

```bash
pip install requests
```

### 运行测试

```bash
cd C:\Users\cqc\Downloads\coding
python backend/test_api.py
```

脚本将按以下顺序测试API：

1. 健康检查 (`/health`)
2. 数据库连接测试 (`/test/db`)
3. 用户注册 (`/api/users/register`)
4. 用户登录 (`/api/users/login`)
5. 获取用户信息 (`/api/users/all/list`)
6. 上传运动记录 (`/api/user/upload_workout`)
7. 获取跑步记录 (`/api/user/running_records`)

测试结果将直接显示在命令行中。

## 使用HTML页面测试

HTML页面提供了一个直观的界面，可以单独测试每个API并查看结果。

### 使用方法

1. 确保后端服务器已启动
2. 在浏览器中打开 `test_api.html` 文件
3. 按照界面上的顺序点击按钮测试各个API：
   - 先测试健康检查和数据库连接
   - 然后注册新用户
   - 使用新注册的用户登录获取令牌
   - 登录成功后测试其他需要授权的API

### 注意事项

- 注册用户时会自动在用户名后添加时间戳，确保用户名唯一
- 登录成功后，令牌会自动保存并用于后续的API请求
- 每个API测试结果会显示在对应卡片的下方

## 可能的问题及解决方案

1. **CORS错误**：如果在HTML页面测试时遇到CORS错误，请确保后端服务的CORS设置正确。

2. **连接失败**：如果无法连接到服务器，请检查：
   - 服务器是否正在运行
   - 端口是否正确（默认5000）
   - 是否有防火墙阻止连接

3. **数据库连接失败**：如果数据库连接测试失败，请检查：
   - 数据库服务器是否运行
   - 数据库连接配置是否正确

4. **授权错误**：如果授权相关API失败，请确保：
   - 已成功登录并获取有效令牌
   - 令牌格式正确（Bearer + 空格 + 令牌） 