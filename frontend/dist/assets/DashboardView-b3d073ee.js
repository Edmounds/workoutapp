import{u as E,i as H,a as X,b as j,c as J,d as K,H as O}from"./index.esm.min-d531ee05.js";import{g as Q,a as Y,b as Z,c as tt,d as et}from"./index-e30b2ae2.js";import{_ as at,r as v,c as w,w as L,o as lt,a as r,b as i,d as g,e as l,f as k,g as a,F as st,h as t,t as d,n as ot,i as p,u as $}from"./index-fd31ae45.js";import{i as nt,a as rt}from"./install-c70f0a58.js";import{i as it}from"./install-40534a35.js";const dt={class:"dashboard-view pa-4"},ut={class:"text-h5 font-weight-bold"},ct={class:"text-caption text-green"},_t={class:"text-h5 font-weight-bold"},vt={class:"text-caption text-green"},pt={class:"text-h5 font-weight-bold"},mt={class:"text-caption text-green"},ft={class:"text-h5 font-weight-bold"},gt={key:1,class:"text-center pt-10"},yt={key:1,class:"text-center pt-10"},xt={key:1,class:"text-center pt-10"},bt={key:1,class:"text-center pt-10"},ht={class:"d-flex flex-column align-center"},wt={class:"health-circle primary lighten-4"},kt={class:"text-h5"},zt={class:"d-flex flex-column align-center"},Dt={class:"health-circle info lighten-4"},Tt={class:"text-h5"},Vt={__name:"DashboardView",setup(St){E([H,X,nt,it,j,J,K,rt]);const A=v(!0),n=v({}),y=v("month"),x=v([]),b=v("workouts"),z=v([]),D=v([]),B=v([]),R=w(()=>!n.value.total_users||!n.value.active_users_today?0:Math.round(n.value.active_users_today/n.value.total_users*100)),M=w(()=>({tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},legend:{data:["新增用户","累计用户"],right:10,top:0},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:{type:"category",data:x.value.map(s=>s.date)},yAxis:[{type:"value",name:"新增用户",position:"left"},{type:"value",name:"累计用户",position:"right"}],series:[{name:"新增用户",type:"bar",data:x.value.map(s=>s.new_users)},{name:"累计用户",type:"line",yAxisIndex:1,data:x.value.map(s=>s.cumulative_users),symbol:"circle",symbolSize:8,lineStyle:{width:3}}]})),F=w(()=>({tooltip:{trigger:"item",formatter:"{a} <br/>{b}: {c} ({d}%)"},legend:{orient:"vertical",left:10,top:"center",data:D.value.map(s=>s.label)},series:[{name:"性别分布",type:"pie",radius:["50%","70%"],avoidLabelOverlap:!1,label:{show:!1,position:"center"},emphasis:{label:{show:!0,fontSize:"18",fontWeight:"bold"}},labelLine:{show:!1},data:D.value.map(s=>({value:s.count,name:s.label})),itemStyle:{borderRadius:10,borderColor:"#fff",borderWidth:2}}]})),I=w(()=>({tooltip:{trigger:"item",formatter:"{a} <br/>{b}: {c} ({d}%)"},legend:{type:"scroll",orient:"vertical",right:10,top:"center"},series:[{name:"运动类型",type:"pie",radius:"55%",center:["40%","50%"],data:B.value.map(s=>({value:s.count,name:s.workout_type||"未分类"})),emphasis:{itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}]})),P=w(()=>{const s=b.value;let e,u;return s==="workouts"?(e="运动次数",u="次数"):s==="distance"?(e="运动距离",u="距离(km)"):(e="运动时长",u="时长(分钟)"),{tooltip:{trigger:"axis"},xAxis:{type:"category",data:z.value.map(o=>o.date),boundaryGap:!1},yAxis:{type:"value",name:u},series:[{name:e,type:"line",data:z.value.map(o=>o.value),areaStyle:{opacity:.3},smooth:!0,lineStyle:{width:3},symbol:"circle",symbolSize:8}]}});async function q(){A.value=!0;try{const s=await Q();s.code===200&&(n.value=s.data),await W();const e=await Y();e.code===200&&(D.value=e.data);const u=await Z();u.code===200&&(B.value=u.data),await C()}catch(s){console.error("加载仪表盘数据错误:",s)}finally{A.value=!1}}async function W(){try{const s={period:y.value,count:12},e=await tt(s);e.code===200&&(x.value=e.data.data)}catch(s){console.error("加载用户增长趋势错误:",s)}}async function C(){try{const s={period:y.value,metric:b.value,count:12},e=await et(s);e.code===200&&(z.value=e.data.data)}catch(s){console.error("加载运动趋势错误:",s)}}return L(y,()=>{W(),C()}),L(b,()=>{C()}),lt(()=>{q()}),(s,e)=>{const u=r("v-progress-circular"),o=r("v-col"),m=r("v-row"),T=r("v-icon"),V=r("v-avatar"),S=r("v-card-item"),c=r("v-card-text"),_=r("v-card"),N=r("v-spacer"),f=r("v-btn"),U=r("v-btn-toggle"),h=r("v-card-title");return i(),g("div",dt,[e[23]||(e[23]=l("h1",{class:"text-h4 mb-6"},"系统概览",-1)),A.value?(i(),k(m,{key:0},{default:a(()=>[t(o,{cols:"12",class:"text-center"},{default:a(()=>[t(u,{indeterminate:"",color:"primary",size:"60"})]),_:1})]),_:1})):(i(),g(st,{key:1},[t(m,null,{default:a(()=>[t(o,{cols:"12",sm:"6",lg:"3"},{default:a(()=>[t(_,{class:"stat-card elevation-3",rounded:"lg"},{default:a(()=>[t(S,null,{prepend:a(()=>[t(V,{rounded:"",color:"primary",variant:"tonal",class:"mr-3"},{default:a(()=>[t(T,{size:"24",icon:"mdi-account-group"})]),_:1})]),default:a(()=>[l("div",null,[l("div",ut,d(n.value.total_users||0),1),e[2]||(e[2]=l("div",{class:"text-subtitle-2 text-grey"},"总用户数",-1))])]),_:1}),t(c,{class:"text-right py-0"},{default:a(()=>[l("span",ct,"+"+d(n.value.new_users_today||0)+" 今日新增",1)]),_:1})]),_:1})]),_:1}),t(o,{cols:"12",sm:"6",lg:"3"},{default:a(()=>[t(_,{class:"stat-card elevation-3",rounded:"lg"},{default:a(()=>[t(S,null,{prepend:a(()=>[t(V,{rounded:"",color:"info",variant:"tonal",class:"mr-3"},{default:a(()=>[t(T,{size:"24",icon:"mdi-run"})]),_:1})]),default:a(()=>[l("div",null,[l("div",_t,d(n.value.total_workouts||0),1),e[3]||(e[3]=l("div",{class:"text-subtitle-2 text-grey"},"总运动次数",-1))])]),_:1}),t(c,{class:"text-right py-0"},{default:a(()=>[l("span",vt,"+"+d(n.value.workouts_today||0)+" 今日新增",1)]),_:1})]),_:1})]),_:1}),t(o,{cols:"12",sm:"6",lg:"3"},{default:a(()=>[t(_,{class:"stat-card elevation-3",rounded:"lg"},{default:a(()=>[t(S,null,{prepend:a(()=>[t(V,{rounded:"",color:"success",variant:"tonal",class:"mr-3"},{default:a(()=>[t(T,{size:"24",icon:"mdi-map-marker-distance"})]),_:1})]),default:a(()=>[l("div",null,[l("div",pt,d(n.value.total_distance||0)+" km",1),e[4]||(e[4]=l("div",{class:"text-subtitle-2 text-grey"},"总运动距离",-1))])]),_:1}),t(c,{class:"text-right py-0"},{default:a(()=>[l("span",mt,"+"+d(n.value.distance_today||0)+" km 今日新增",1)]),_:1})]),_:1})]),_:1}),t(o,{cols:"12",sm:"6",lg:"3"},{default:a(()=>[t(_,{class:"stat-card elevation-3",rounded:"lg"},{default:a(()=>[t(S,null,{prepend:a(()=>[t(V,{rounded:"",color:"warning",variant:"tonal",class:"mr-3"},{default:a(()=>[t(T,{size:"24",icon:"mdi-account-clock"})]),_:1})]),default:a(()=>[l("div",null,[l("div",ft,d(n.value.active_users_today||0),1),e[5]||(e[5]=l("div",{class:"text-subtitle-2 text-grey"},"今日活跃用户",-1))])]),_:1}),t(c,{class:"text-right py-0"},{default:a(()=>[l("span",{class:ot(["text-caption",R.value>10?"text-green":"text-orange"])},d(R.value)+"% 活跃率 ",3)]),_:1})]),_:1})]),_:1})]),_:1}),t(m,{class:"mt-4"},{default:a(()=>[t(o,{cols:"12",md:"8"},{default:a(()=>[t(_,{class:"elevation-3",height:"400",rounded:"lg"},{default:a(()=>[t(h,{class:"d-flex align-center"},{default:a(()=>[e[9]||(e[9]=l("span",null,"用户增长趋势",-1)),t(N),t(U,{modelValue:y.value,"onUpdate:modelValue":e[0]||(e[0]=G=>y.value=G),mandatory:""},{default:a(()=>[t(f,{value:"week",density:"compact",variant:"text"},{default:a(()=>e[6]||(e[6]=[p("周")])),_:1,__:[6]}),t(f,{value:"month",density:"compact",variant:"text"},{default:a(()=>e[7]||(e[7]=[p("月")])),_:1,__:[7]}),t(f,{value:"year",density:"compact",variant:"text"},{default:a(()=>e[8]||(e[8]=[p("年")])),_:1,__:[8]})]),_:1},8,["modelValue"])]),_:1,__:[9]}),t(c,{class:"chart-container"},{default:a(()=>[x.value.length>0?(i(),k($(O),{key:0,class:"chart",option:M.value,autoresize:""},null,8,["option"])):(i(),g("div",gt,e[10]||(e[10]=[l("p",{class:"text-body-1"},"暂无数据",-1)])))]),_:1})]),_:1})]),_:1}),t(o,{cols:"12",md:"4"},{default:a(()=>[t(_,{class:"elevation-3",height:"400",rounded:"lg"},{default:a(()=>[t(h,null,{default:a(()=>e[11]||(e[11]=[p("用户性别分布")])),_:1,__:[11]}),t(c,{class:"chart-container"},{default:a(()=>[D.value.length>0?(i(),k($(O),{key:0,class:"chart",option:F.value,autoresize:""},null,8,["option"])):(i(),g("div",yt,e[12]||(e[12]=[l("p",{class:"text-body-1"},"暂无数据",-1)])))]),_:1})]),_:1})]),_:1})]),_:1}),t(m,{class:"mt-4"},{default:a(()=>[t(o,{cols:"12",md:"6"},{default:a(()=>[t(_,{class:"elevation-3",height:"400",rounded:"lg"},{default:a(()=>[t(h,{class:"d-flex align-center"},{default:a(()=>e[13]||(e[13]=[l("span",null,"运动类型分布",-1)])),_:1,__:[13]}),t(c,{class:"chart-container"},{default:a(()=>[B.value.length>0?(i(),k($(O),{key:0,class:"chart",option:I.value,autoresize:""},null,8,["option"])):(i(),g("div",xt,e[14]||(e[14]=[l("p",{class:"text-body-1"},"暂无数据",-1)])))]),_:1})]),_:1})]),_:1}),t(o,{cols:"12",md:"6"},{default:a(()=>[t(_,{class:"elevation-3",height:"400",rounded:"lg"},{default:a(()=>[t(h,{class:"d-flex align-center"},{default:a(()=>[e[18]||(e[18]=l("span",null,"运动趋势",-1)),t(N),t(U,{modelValue:b.value,"onUpdate:modelValue":e[1]||(e[1]=G=>b.value=G),mandatory:""},{default:a(()=>[t(f,{value:"workouts",density:"compact",variant:"text"},{default:a(()=>e[15]||(e[15]=[p("次数")])),_:1,__:[15]}),t(f,{value:"distance",density:"compact",variant:"text"},{default:a(()=>e[16]||(e[16]=[p("距离")])),_:1,__:[16]}),t(f,{value:"duration",density:"compact",variant:"text"},{default:a(()=>e[17]||(e[17]=[p("时长")])),_:1,__:[17]})]),_:1},8,["modelValue"])]),_:1,__:[18]}),t(c,{class:"chart-container"},{default:a(()=>[z.value.length>0?(i(),k($(O),{key:0,class:"chart",option:P.value,autoresize:""},null,8,["option"])):(i(),g("div",bt,e[19]||(e[19]=[l("p",{class:"text-body-1"},"暂无数据",-1)])))]),_:1})]),_:1})]),_:1})]),_:1}),t(m,{class:"mt-4"},{default:a(()=>[t(o,{cols:"12"},{default:a(()=>[t(_,{class:"elevation-3",rounded:"lg"},{default:a(()=>[t(h,null,{default:a(()=>e[20]||(e[20]=[p("健康数据概览")])),_:1,__:[20]}),t(c,null,{default:a(()=>[t(m,null,{default:a(()=>[t(o,{cols:"12",sm:"6",md:"3"},{default:a(()=>[l("div",ht,[l("div",wt,[l("span",kt,d(n.value.avg_health_index||0),1)]),e[21]||(e[21]=l("div",{class:"text-subtitle-1 mt-2"},"平均健康指数",-1))])]),_:1}),t(o,{cols:"12",sm:"6",md:"3"},{default:a(()=>[l("div",zt,[l("div",Dt,[l("span",Tt,d(n.value.avg_sleep_quality||0),1)]),e[22]||(e[22]=l("div",{class:"text-subtitle-1 mt-2"},"平均睡眠质量",-1))])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})],64))])}}},Gt=at(Vt,[["__scopeId","data-v-a0076cee"]]);export{Gt as default};
