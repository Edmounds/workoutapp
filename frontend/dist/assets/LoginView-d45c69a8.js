import{_ as U,j as q,r as d,k as B,a as o,b as C,d as j,h as t,g as a,e as z,i as v,l as D,t as E}from"./index-f43b9162.js";import{e as J}from"./index-4b301e06.js";const M={class:"login-page"},O={__name:"LoginView",setup(P){const b=q(),x=d(null),u=d(!1),m=d(""),p=d(""),c=d(!1),_=d(!1),l=B({show:!1,text:"",color:"error"}),f={required:i=>!!i||"此字段为必填项"};async function y(){var i,e;if(u.value){_.value=!0;try{const s={name:m.value,password:p.value},r=await J(s);r.code===200?(localStorage.setItem("token",r.data.token),localStorage.setItem("user",JSON.stringify(r.data)),b.push("/")):(l.text=r.message||"登录失败，请检查用户名和密码",l.color="error",l.show=!0)}catch(s){console.error("登录错误:",s),l.text=((e=(i=s.response)==null?void 0:i.data)==null?void 0:e.message)||"登录失败，请稍后再试",l.color="error",l.show=!0}finally{_.value=!1}}}return(i,e)=>{const s=o("v-card-title"),r=o("v-card-subtitle"),g=o("v-text-field"),w=o("v-btn"),V=o("v-form"),k=o("v-card-text"),h=o("v-card"),S=o("v-col"),I=o("v-row"),L=o("v-container"),N=o("v-snackbar");return C(),j("div",M,[t(L,{fluid:"",class:"fill-height"},{default:a(()=>[t(I,{align:"center",justify:"center"},{default:a(()=>[t(S,{cols:"12",sm:"10",md:"8",lg:"6",xl:"4"},{default:a(()=>[t(h,{class:"login-card elevation-12",rounded:"lg"},{default:a(()=>[t(s,{class:"text-center pt-8 pb-2"},{default:a(()=>e[5]||(e[5]=[z("div",{class:"text-h3 font-weight-bold primary--text"},"运动手环数据管理系统",-1)])),_:1,__:[5]}),t(r,{class:"text-center pb-6 text-h6"},{default:a(()=>e[6]||(e[6]=[v(" 管理员登录 ")])),_:1,__:[6]}),t(k,null,{default:a(()=>[t(V,{ref_key:"form",ref:x,modelValue:u.value,"onUpdate:modelValue":e[3]||(e[3]=n=>u.value=n),onSubmit:D(y,["prevent"])},{default:a(()=>[t(g,{modelValue:m.value,"onUpdate:modelValue":e[0]||(e[0]=n=>m.value=n),label:"用户名","prepend-inner-icon":"mdi-account",rules:[f.required],variant:"outlined",class:"mb-6",autocomplete:"username",density:"comfortable","bg-color":"grey-lighten-5","hide-details":"auto"},null,8,["modelValue","rules"]),t(g,{modelValue:p.value,"onUpdate:modelValue":e[1]||(e[1]=n=>p.value=n),label:"密码","prepend-inner-icon":"mdi-lock",rules:[f.required],variant:"outlined",type:c.value?"text":"password","append-inner-icon":c.value?"mdi-eye-off":"mdi-eye","onClick:appendInner":e[2]||(e[2]=n=>c.value=!c.value),autocomplete:"current-password",density:"comfortable","bg-color":"grey-lighten-5","hide-details":"auto"},null,8,["modelValue","rules","type","append-inner-icon"]),t(w,{loading:_.value,disabled:!u.value||_.value,color:"primary",size:"x-large",block:"",type:"submit",class:"mt-8 py-3",elevation:"2"},{default:a(()=>e[7]||(e[7]=[v(" 登录 ")])),_:1,__:[7]},8,["loading","disabled"])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),t(N,{modelValue:l.show,"onUpdate:modelValue":e[4]||(e[4]=n=>l.show=n),color:l.color,top:"",centered:"",timeout:"3000"},{default:a(()=>[v(E(l.text),1)]),_:1},8,["modelValue","color"])])}}},$=U(O,[["__scopeId","data-v-915b225b"]]);export{$ as default};
