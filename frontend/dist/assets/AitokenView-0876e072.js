import{_ as S,r as i,o as B,b as r,d,e,H as y,I as A,t,s as c,n as P,i as p}from"./index-fd31ae45.js";import{q as L}from"./index-e30b2ae2.js";const N={name:"AitokenView",setup(){const u=i("sk-2aee504fdb5e4c3f84205c1f398b801b"),s=i(!1),l=i(null),a=i(!1),v=i(""),g=i(null),o=i("https://api.deepseek.com"),_=i(!1),b=async()=>{if(!u.value){v.value="请输入API密钥";return}a.value=!0,v.value="";try{const n=await L(u.value,o.value);l.value={is_available:n.is_available,balance_infos:n.balance_infos||[]},g.value=new Date,v.value="",localStorage.setItem("deepseek_api_key",u.value),localStorage.setItem("deepseek_api_base_url",o.value)}catch(n){console.error("获取API账户余额失败:",n),v.value="获取API账户余额失败: "+(n.message||"网络错误"),l.value=null}finally{a.value=!1}},k=()=>{s.value=!s.value},m=()=>{_.value=!_.value},h=n=>n?n.substring(0,3)+"..."+n.substring(n.length-4):"",I=()=>!l.value||!l.value.balance_infos||l.value.balance_infos.length===0?"0.00":l.value.balance_infos[0].total_balance||"0.00",w=()=>!l.value||!l.value.balance_infos||l.value.balance_infos.length===0?"0.00":l.value.balance_infos[0].granted_balance||"0.00",D=()=>!l.value||!l.value.balance_infos||l.value.balance_infos.length===0?"0.00":l.value.balance_infos[0].topped_up_balance||"0.00",U=()=>!l.value||!l.value.balance_infos||l.value.balance_infos.length===0?"CNY":l.value.balance_infos[0].currency||"CNY",K=n=>n?new Date(n).toLocaleDateString("zh-CN"):"N/A",C=n=>n?n.toLocaleString("zh-CN"):"N/A";return B(()=>{const n=localStorage.getItem("deepseek_api_key"),f=localStorage.getItem("deepseek_api_base_url");n&&(u.value=n),f&&(o.value=f),u.value&&b()}),{apiKey:u,showApiKey:s,usageData:l,isLoading:a,error:v,lastUpdated:g,apiBaseUrl:o,showAdvanced:_,fetchApiUsage:b,toggleShowApiKey:k,toggleAdvancedSettings:m,maskApiKey:h,getTotalBalance:I,getGrantedBalance:w,getToppedUpBalance:D,getCurrency:U,formatDate:K,formatDateTime:C}}},V={class:"aitoken-container"},T={class:"card"},x={class:"api-key-section"},z={class:"input-group"},R=["disabled"],G={key:0,class:"key-info"},M={class:"advanced-toggle"},Y={key:1,class:"advanced-settings"},q={class:"input-group"},E={key:0,class:"loading-section"},H={key:1,class:"error-section"},j={class:"error-message"},F={key:0,class:"error-suggestions"},J={key:2,class:"usage-section"},O={key:0,class:"account-status"},Q={class:"usage-cards"},W={class:"usage-card"},X={class:"usage-value"},Z={class:"currency"},$={class:"usage-card"},ee={class:"usage-value"},ae={class:"currency"},se={class:"usage-card"},le={class:"usage-value"},ne={class:"currency"},te={class:"usage-details"},oe={class:"details-table"};function ie(u,s,l,a,v,g){return r(),d("div",V,[s[18]||(s[18]=e("h1",null,"DeepSeek API 账户余额",-1)),e("div",T,[e("div",x,[s[7]||(s[7]=e("h2",null,"API 密钥",-1)),e("div",z,[y(e("input",{"onUpdate:modelValue":s[0]||(s[0]=o=>a.apiKey=o),type:"password",placeholder:"输入DeepSeek API密钥",class:"api-input"},null,512),[[A,a.apiKey]]),e("button",{onClick:s[1]||(s[1]=(...o)=>a.toggleShowApiKey&&a.toggleShowApiKey(...o)),class:"toggle-btn"},t(a.showApiKey?"隐藏":"显示"),1),e("button",{onClick:s[2]||(s[2]=(...o)=>a.fetchApiUsage&&a.fetchApiUsage(...o)),class:"fetch-btn",disabled:a.isLoading},t(a.isLoading?"加载中...":"查询"),9,R)]),a.apiKey?(r(),d("div",G," 当前密钥: "+t(a.showApiKey?a.apiKey:a.maskApiKey(a.apiKey)),1)):c("",!0),e("div",M,[e("button",{onClick:s[3]||(s[3]=(...o)=>a.toggleAdvancedSettings&&a.toggleAdvancedSettings(...o)),class:"advanced-btn"},t(a.showAdvanced?"隐藏高级设置":"显示高级设置"),1)]),a.showAdvanced?(r(),d("div",Y,[e("div",q,[s[5]||(s[5]=e("label",{for:"api-base-url"},"API基础URL:",-1)),y(e("input",{id:"api-base-url","onUpdate:modelValue":s[4]||(s[4]=o=>a.apiBaseUrl=o),type:"text",placeholder:"输入API基础URL",class:"api-input"},null,512),[[A,a.apiBaseUrl]])]),s[6]||(s[6]=e("div",{class:"settings-info"},[e("p",null,"默认URL: https://api.deepseek.com"),e("p",null,"如遇连接问题，请尝试更改API地址或检查网络连接")],-1))])):c("",!0)]),a.isLoading?(r(),d("div",E,s[8]||(s[8]=[e("div",{class:"loading-spinner"},null,-1),e("p",null,"正在获取API账户余额数据...",-1)]))):c("",!0),a.error?(r(),d("div",H,[e("p",j,t(a.error),1),a.error.includes("网络错误")||a.error.includes("无法连接")?(r(),d("div",F,s[9]||(s[9]=[e("p",null,"可能的解决方案:",-1),e("ul",null,[e("li",null,"检查您的网络连接"),e("li",null,"确认API密钥是否正确"),e("li",null,"尝试使用代理或VPN"),e("li",null,"在高级设置中更改API地址")],-1)]))):c("",!0)])):c("",!0),a.usageData&&!a.isLoading?(r(),d("div",J,[s[17]||(s[17]=e("h2",null,"账户余额信息",-1)),a.usageData.is_available!==void 0?(r(),d("div",O,[e("div",{class:P(["status-badge",a.usageData.is_available?"status-active":"status-inactive"])},t(a.usageData.is_available?"账户可用":"账户不可用"),3)])):c("",!0),e("div",Q,[e("div",W,[s[10]||(s[10]=e("h3",null,"总余额",-1)),e("div",X,[p(t(a.getTotalBalance())+" ",1),e("span",Z,t(a.getCurrency()),1)])]),e("div",$,[s[11]||(s[11]=e("h3",null,"充值余额",-1)),e("div",ee,[p(t(a.getToppedUpBalance())+" ",1),e("span",ae,t(a.getCurrency()),1)])]),e("div",se,[s[12]||(s[12]=e("h3",null,"赠送余额",-1)),e("div",le,[p(t(a.getGrantedBalance())+" ",1),e("span",ne,t(a.getCurrency()),1)])])]),e("div",te,[s[16]||(s[16]=e("h3",null,"详细信息",-1)),e("table",oe,[e("tbody",null,[e("tr",null,[s[13]||(s[13]=e("td",null,"账户状态:",-1)),e("td",null,t(a.usageData.is_available?"可用":"不可用"),1)]),e("tr",null,[s[14]||(s[14]=e("td",null,"货币单位:",-1)),e("td",null,t(a.getCurrency()),1)]),e("tr",null,[s[15]||(s[15]=e("td",null,"上次更新时间:",-1)),e("td",null,t(a.formatDateTime(a.lastUpdated)),1)])])])])])):c("",!0)])])}const ue=S(N,[["render",ie],["__scopeId","data-v-9d21f51c"]]);export{ue as default};
