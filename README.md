# API测试程序

## 项目说明

本测试程序用于验证后端API接口与API文档的一致性，以及测试数据库数据交换功能是否正常工作。测试会检查API的响应格式、字段和状态码是否与文档描述一致，同时验证数据是否正确写入数据库。

## 功能特点

- 测试API接口与文档描述的一致性
- 验证API接口的正确性和可用性
- 测试数据库交互和数据持久化功能
- 自动化测试流程，便于持续集成
- 彩色输出，提高测试结果可读性

## 测试范围

测试程序覆盖以下API端点：

1. `POST /api/users/login` - 用户登录
2. `GET /api/users/all/list` - 获取用户信息
3. `GET /api/user/running_records` - 获取跑步记录
4. `POST /api/user/upload_workout` - 上传运动数据
5. `GET /api/physical/stats` - 获取体能数据
6. `GET /api/nutrition/tips` - 获取营养建议
7. `PUT /api/users/update` - 更新用户信息
8. `GET /api/ai/advice` - 获取AI建议

## 环境准备

### 安装依赖

```bash
pip install -r requirements.txt
```

### 配置

测试程序使用的默认配置：

- 服务器地址：`http://localhost:5000`
- 数据库地址：`113.45.220.0:3306`
- 数据库用户：`cxr`
- 数据库名称：`workout_app`

如需修改，请编辑`api_test.py`文件中的配置部分。

## 使用方法

### 运行测试

确保后端服务器已启动，然后执行：

```bash
python api_test.py
```

### 测试结果

测试程序会输出彩色结果，包括：

- 绿色：测试通过
- 红色：测试失败或错误
- 黄色：进行中的操作
- 蓝色：测试信息

测试结束后会显示汇总信息，包括测试总数、成功数、失败数和错误数。

## 注意事项

1. 确保后端服务器正在运行
2. 确保数据库服务可访问
3. 测试会向数据库写入真实数据，请注意使用测试环境
4. 测试用户需已存在于数据库中（默认使用"cxyyy"）

## 开发扩展

如需添加新的测试用例，请按以下步骤操作：

1. 在`APIDocConsistencyTest`类中添加新的测试方法
2. 方法名以`test_`开头
3. 遵循现有测试方法的模式，包括发送请求、检查响应和验证数据 